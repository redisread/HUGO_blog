---
title: 1-è€ƒè™‘ä»¥é™æ€å·¥å‚æ–¹æ³•ä»£æ›¿æ„é€ å‡½æ•°-ã€ŠEffective Javaã€‹ç¬”è®°
date: 2021-10-16T16:42:14+08:00
description: Consider static factory methods instead of constructorsã€‚
draft: false
hideToc: false
enableToc: true
enableTocContent: false
tocPosition: outer
author: Victor
authorEmoji: ğŸ‘»
image: https://cos.jiahongw.com/uPic/image-20211016174809419.png
plantuml: true
libraries:
- katex
- mathjax
tags:
- EffectiveJava
series:
- EffectiveJava
categories:
-
---



<!--ç¬¬äºŒç« ï¼šåˆ›å»ºå’Œé”€æ¯å¯¹è±¡-->



### ä»€ä¹ˆæ˜¯é™æ€å·¥å‚æ–¹æ³•ï¼Ÿ

ä¸€ä¸ªç±»å¯ä»¥æä¾›å…¬å…±é™æ€å·¥å‚æ–¹æ³•ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªè¿”å›ç±»å®ä¾‹çš„é™æ€æ–¹æ³•ã€‚

ä¾‹å¦‚Boolean ï¼ˆboolean çš„åŒ…è£…ç±»ï¼‰çš„ç®€å•ç¤ºä¾‹ã€‚è¯¥æ–¹æ³•å°† boolean åŸºæœ¬ç±»å‹è½¬æ¢ä¸º Boolean å¯¹è±¡çš„å¼•ç”¨ï¼š

```java
public static Boolean valueOf(boolean b) {
	return b ? Boolean.TRUE : Boolean.FALSE;
}
```

> è¦æ³¨æ„çš„æ˜¯é™æ€å·¥å‚æ–¹æ³•ä¸æ¥è‡ªè®¾è®¡æ¨¡å¼çš„å·¥å‚æ–¹æ³•æ¨¡å¼ä¸åŒ [Gamma95]ã€‚æœ¬æ¡ç›®ä¸­æè¿°çš„é™æ€å·¥å‚æ–¹æ³•åœ¨è®¾è®¡æ¨¡å¼ä¸­æ²¡æœ‰ç›´æ¥ç­‰ä»·çš„æ–¹æ³•ã€‚



### é™æ€å·¥å‚æ–¹æ³•çš„ä¼˜ç‚¹

#### 1 é™æ€å·¥å‚æ–¹æ³•æœ‰ç¡®åˆ‡åç§°ï¼ˆæ›´åŠ æ¸…æ™°ï¼‰

å¦‚æœæ„é€ å‡½æ•°çš„å‚æ•°æœ¬èº«å¹¶ä¸èƒ½æè¿°è¿”å›çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå…·æœ‰ç¡®åˆ‡åç§°çš„é™æ€å·¥å‚åˆ™æ›´å®¹æ˜“ä½¿ç”¨ï¼Œç”Ÿæˆçš„å®¢æˆ·ç«¯ä»£ç ä¹Ÿæ›´å®¹æ˜“é˜…è¯»ã€‚æœ€ç®€å•çš„ä¾‹å­ï¼Œè¿”å›å¯èƒ½ä¸ºç´ æ•°çš„ BigInteger ç±»çš„æ„é€ å‡½æ•° `BigInteger(int, int, Random)` æœ€å¥½è¡¨ç¤ºä¸ºåä¸º `BigInteger.probablePrime` çš„é™æ€å·¥å‚æ–¹æ³•ã€‚

> ä¸€ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªå…·æœ‰ç»™å®šç­¾åçš„æ„é€ å‡½æ•°ã€‚ä½†æ˜¯ç¨‹åºå‘˜å¯ä»¥é€šè¿‡æä¾›å¤šä¸ªæ„é€ å‡½æ•°æ¥ç»•è¿‡è¿™ä¸ªé™åˆ¶ï¼Œè¿™äº›æ„é€ å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä»…åœ¨å‚æ•°ç±»å‹ã€ä¸ªæ•°æˆ–é¡ºåºä¸Šæœ‰æ‰€ä¸åŒã€‚**é¢å¯¹è¿™æ ·ä¸€ä¸ª APIï¼Œç”¨æˆ·å°†æ°¸è¿œæ— æ³•è®°ä½è¯¥ç”¨å“ªä¸ªæ„é€ å‡½æ•°ï¼Œå¹¶ä¸”æœ€ç»ˆä¼šé”™è¯¯åœ°è°ƒç”¨ä¸é€‚åˆçš„æ„é€ å‡½æ•°ã€‚å¦‚æœä¸å‚è€ƒç±»æ–‡æ¡£ï¼Œé˜…è¯»ä½¿ç”¨è¿™äº›æ„é€ å‡½æ•°ä»£ç çš„äººå°±ä¸ä¼šçŸ¥é“ä»£ç çš„ä½œç”¨ã€‚**



#### 2 é™æ€å·¥å‚æ–¹æ³•ä¸éœ€è¦åœ¨æ¯æ¬¡è°ƒç”¨æ—¶åˆ›å»ºæ–°å¯¹è±¡ï¼ˆèŠ‚çœå†…å­˜ï¼‰

`Boolean.valueOf(boolean)` æ–¹æ³•è¯´æ˜äº†è¿™ç§æŠ€æœ¯ï¼šå®ƒä»ä¸åˆ›å»ºå¯¹è±¡ã€‚è¿™ç§æŠ€æœ¯ç±»ä¼¼äºäº«å…ƒæ¨¡å¼ [Gamma95]ã€‚**å¦‚æœç»å¸¸è¯·æ±‚ç›¸åŒçš„å¯¹è±¡ï¼Œç‰¹åˆ«æ˜¯åœ¨åˆ›å»ºå¯¹è±¡çš„ä»£ä»·å¾ˆé«˜æ—¶ï¼Œå®ƒå¯ä»¥æå¤§åœ°æé«˜æ€§èƒ½ã€‚**

> ä»€ä¹ˆæ˜¯äº«å…ƒæ¨¡å¼ï¼ˆFlyweight Design Patternï¼‰ï¼Ÿ
>
> ***æ‰€è°“â€œäº«å…ƒâ€ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯è¢«å…±äº«çš„å•å…ƒã€‚äº«å…ƒæ¨¡å¼çš„æ„å›¾æ˜¯å¤ç”¨å¯¹è±¡ï¼ŒèŠ‚çœå†…å­˜ï¼Œå‰ææ˜¯äº«å…ƒå¯¹è±¡æ˜¯ä¸å¯å˜å¯¹è±¡ã€‚***

**æšä¸¾ç±»å‹ä¹Ÿæä¾›äº†è¿™ç§ä¿è¯ã€‚**



#### 3 å¯ä»¥é€šè¿‡é™æ€å·¥å‚æ–¹æ³•è·å–åŸè¿”å›ç±»å‹çš„ä»»ä½•å­ç±»çš„å¯¹è±¡ï¼ˆéšè—å®ç°ç±»ï¼‰

è¿™ç§çµæ´»æ€§çš„ä¸€ä¸ªåº”ç”¨æ˜¯ APIå¯ä»¥è¿”å›å¯¹è±¡ï¼Œä½†åˆä¸ä¼šä½¿å¯¹è±¡çš„ç±»å˜æˆå…±æœ‰çš„ã€‚ï¼ˆ**ç±»å¯ä»¥æ˜¯ç§æœ‰çš„ï¼Œé€šè¿‡å…±æœ‰çš„é™æ€å·¥å‚æ–¹æ³•è¿›è¡Œè¿”å›**ï¼‰ä»¥è¿™ç§æ–¹å¼éšè—å®ç°ç±»ä¼šå½¢æˆä¸€ä¸ªéå¸¸ç´§å‡‘çš„ APIã€‚è¿™ç§æŠ€æœ¯é€‚ç”¨äºåŸºäºæ¥å£çš„æ¡†æ¶ï¼Œå…¶ä¸­**æ¥å£ä¸ºé™æ€å·¥å‚æ–¹æ³•æä¾›äº†è‡ªç„¶çš„è¿”å›ç±»å‹**ã€‚

> Collections æ¡†æ¶ API æ¯”å®ƒå¯¼å‡º 45 ä¸ªç‹¬ç«‹çš„å…¬å…±ç±»è¦å°å¾—å¤šï¼Œæ¯ä¸ªå…¬å…±ç±»å¯¹åº”ä¸€ä¸ªæ–¹ä¾¿çš„å®ç°ã€‚å‡å°‘çš„ä¸ä»…ä»…æ˜¯ API çš„æ•°é‡ï¼Œè¿˜æœ‰æ¦‚å¿µä¸Šçš„å‡å°‘ï¼šç¨‹åºå‘˜ä¸ºäº†ä½¿ç”¨ API å¿…é¡»æŒæ¡çš„æ¦‚å¿µçš„æ•°é‡å’Œéš¾åº¦ã€‚ç¨‹åºå‘˜çŸ¥é“è¿”å›çš„å¯¹è±¡æ˜¯ç”±ç›¸å…³çš„æ¥å£ç²¾ç¡®åœ°æŒ‡å®šçš„ï¼Œå› æ­¤ä¸éœ€è¦ä¸ºå®ç°ç±»é˜…è¯»é¢å¤–çš„ç±»æ–‡æ¡£ã€‚æ­¤å¤–ï¼Œä½¿ç”¨è¿™ç§é™æ€å·¥å‚æ–¹æ³•éœ€è¦å®¢æˆ·ç«¯é€šè¿‡æ¥å£è€Œä¸æ˜¯å®ç°ç±»å¼•ç”¨è¿”å›çš„å¯¹è±¡ï¼Œè¿™é€šå¸¸æ˜¯å¾ˆå¥½çš„åšæ³•ã€‚



#### 4 è¿”å›å¯¹è±¡çš„ç±»å¯ä»¥éšè°ƒç”¨çš„ä¸åŒè€Œå˜åŒ–ï¼Œä½œä¸ºè¾“å…¥å‚æ•°çš„å‡½æ•°

ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ„é€ å‡½æ•°(æˆ–è€…æ˜¯æˆ‘ä»¬éœ€è¦æ„é€ çš„å¯¹è±¡)å’Œå¤–ç•Œä¹‹é—´å¢åŠ äº†ä¸€ä¸ªé™æ€å·¥å‚çš„æ–¹æ³•ä½œä¸ºä¸­é—´å±‚ï¼Œè¿™ä¸ªä¸­é—´å±‚åšä¸€ä¸ªå°è§£è€¦ï¼Œå¯ä»¥åœ¨ä¸­é—´å±‚ä¹Ÿå°±æ˜¯é™æ€å·¥å‚æ–¹æ³•ä¸Šæ‰§è¡Œè‡ªå·±çš„é€»è¾‘ã€‚ä¾‹å¦‚ï¼š

â€‹    EnumSet ç±»æ²¡æœ‰å…¬å…±æ„é€ å‡½æ•°ï¼Œåªæœ‰é™æ€å·¥å‚ã€‚åœ¨ OpenJDK å®ç°ä¸­ï¼Œå®ƒä»¬è¿”å›ä¸¤ä¸ªå­ç±»ä¸­çš„ä¸€ä¸ªå®ä¾‹ï¼Œè¿™å–å†³äºåº•å±‚ enum ç±»å‹çš„å¤§å°ï¼šå¦‚æœå®ƒæœ‰ 64 ä¸ªæˆ–æ›´å°‘çš„å…ƒç´ ï¼Œå°±åƒå¤§å¤šæ•° enum ç±»å‹ä¸€æ ·ï¼Œé™æ€å·¥å‚è¿”å›ä¸€ä¸ª long ç±»å‹çš„ RegularEnumSet å®ä¾‹ï¼›å¦‚æœ enum ç±»å‹æœ‰ 65 ä¸ªæˆ–æ›´å¤šçš„å…ƒç´ ï¼Œå·¥å‚å°†è¿”å›ä¸€ä¸ªç”± `long[]` ç±»å‹çš„ JumboEnumSet å®ä¾‹ã€‚

> å®¢æˆ·ç«¯çœ‹ä¸åˆ°è¿™ä¸¤ä¸ªå®ç°ç±»çš„å­˜åœ¨ã€‚å¦‚æœ RegularEnumSet ä¸å†ä¸ºå°å‹ enum ç±»å‹æä¾›æ€§èƒ½ä¼˜åŠ¿ï¼Œå®ƒå¯èƒ½ä¼šåœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­è¢«æ¶ˆé™¤ï¼Œè€Œä¸ä¼šäº§ç”Ÿä¸è‰¯å½±å“ã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœäº‹å®è¯æ˜ EnumSet æœ‰ç›Šäºæ€§èƒ½ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯ä»¥æ·»åŠ ç¬¬ä¸‰æˆ–ç¬¬å››ä¸ª EnumSet å®ç°ã€‚å®¢æˆ·ç«¯æ—¢ä¸çŸ¥é“ä¹Ÿä¸å…³å¿ƒä»å·¥å‚è¿”å›çš„å¯¹è±¡çš„ç±»ï¼›å®ƒä»¬åªå…³å¿ƒå®ƒæ˜¯ EnumSet çš„æŸä¸ªå­ç±»ã€‚



#### 5 å½“ç¼–å†™åŒ…å«æ–¹æ³•çš„ç±»æ—¶ï¼Œè¿”å›å¯¹è±¡çš„ç±»ä¸éœ€è¦å­˜åœ¨ï¼ˆè§£è€¦ï¼Œéš”ç¦»ï¼‰

è¿™ç§çµæ´»çš„é™æ€å·¥å‚æ–¹æ³•æ„æˆäº†æœåŠ¡æä¾›è€…æ¡†æ¶çš„åŸºç¡€ï¼Œæ¯”å¦‚ Java æ•°æ®åº“è¿æ¥ APIï¼ˆJDBCï¼‰ã€‚æœåŠ¡æä¾›è€…æ¡†æ¶æ˜¯ä¸€ä¸ªç³»ç»Ÿï¼Œå…¶ä¸­æä¾›è€…å®ç°ä¸€ä¸ªæœåŠ¡ï¼Œç³»ç»Ÿä½¿å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨è¿™äº›å®ç°ï¼Œä»è€Œå°†å®¢æˆ·ç«¯ä¸å®ç°åˆ†ç¦»ã€‚

> ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“éœ€è¦ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•è¿›è¡Œè¿”å›å°±å¯ä»¥äº†ï¼Œä¸å¿…çœŸæ­£çš„å»åˆ›å»ºè¿™ä¸ªç±»ã€‚



### é™æ€å·¥å‚æ–¹æ³•çš„å±€é™

#### 1 æ²¡æœ‰å…¬å…±æˆ–å—ä¿æŠ¤æ„é€ å‡½æ•°çš„ç±»ä¸èƒ½è¢«å­ç±»åŒ–

ä¾‹å¦‚ï¼Œä¸å¯èƒ½åœ¨é›†åˆæ¡†æ¶ä¸­å­ç±»åŒ–ä»»ä½•æ–¹ä¾¿çš„å®ç°ç±»ã€‚è¿™å¯èƒ½æ˜¯ä¸€ç§å› ç¥¸å¾—ç¦çš„åšæ³•ï¼Œå› ä¸ºå®ƒé¼“åŠ±ç¨‹åºå‘˜ä½¿ç”¨ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿ï¼Œå¹¶ä¸”å¯¹äºä¸å¯å˜çš„ç±»å‹æ˜¯å¿…éœ€çš„ã€‚

> å› ä¸ºæ„é€ å‡½æ•°ä¸æ˜¯å…±æœ‰çš„æˆ–è€…æ˜¯å—ä¿æŠ¤çš„ï¼Œå­ç±»å°±ä¸èƒ½å¤Ÿè®¿é—®çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œä»è€Œä¸èƒ½å¤Ÿåˆ›å»ºå­ç±»ã€‚ï¼ˆå­ç±»åˆ›å»ºéœ€è¦è°ƒç”¨å¼—çˆ¶ç±»çš„æ„é€ å‡½æ•°åœ¨è°ƒç”¨è‡ªå·±çš„æ„é€ å‡½æ•°ï¼‰



#### 2 ç¨‹åºå‘˜å¾ˆéš¾æ‰¾åˆ°è¿™äº›é™æ€å·¥å‚æ–¹æ³•

å®ƒä»¬åœ¨ API æ–‡æ¡£ä¸­ä¸åƒæ„é€ å‡½æ•°é‚£æ ·å¼•äººæ³¨ç›®ï¼Œå› æ­¤å¾ˆéš¾å¼„æ¸…æ¥šå¦‚ä½•å®ä¾‹åŒ–ä¸€ä¸ªåªæä¾›é™æ€å·¥å‚æ–¹æ³•è€Œæ²¡æœ‰æ„é€ å‡½æ•°çš„ç±»ã€‚ä¸æ­¤åŒæ—¶ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨ç±»æˆ–æ¥å£æ–‡æ¡£ä¸­å¯¹é™æ€å·¥å‚æ–¹æ³•å¤šåŠ ç•™æ„ï¼Œä»¥åŠéµå®ˆé€šç”¨å‘½åçº¦å®šçš„æ–¹å¼æ¥å‡å°‘è¿™ä¸ªå›°æ‰°ã€‚ä¸‹é¢æ˜¯ä¸€äº›é™æ€å·¥å‚æ–¹æ³•çš„å¸¸ç”¨åç§°ã€‚è¿™ä¸ªåˆ—è¡¨è¿˜è¿œä¸å¤Ÿè¯¦å°½ï¼š

| å…³é”®å­—                | æè¿°                                                         | ä½¿ç”¨                                                         |
| --------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| from                  | ä¸€ç§å‹è½¬æ¢æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¥å—å•ä¸ªå‚æ•°å¹¶è¿”å›è¯¥ç±»å‹çš„ç›¸åº”å®ä¾‹     | `Date d = Date.from(instant);`                               |
| of                    | ä¸€ä¸ªèšåˆæ–¹æ³•ï¼Œå®ƒæ¥å—å¤šä¸ªå‚æ•°å¹¶è¿”å›ä¸€ä¸ªåŒ…å«è¿™äº›å‚æ•°çš„å®ä¾‹     | `Set<Rank> faceCards = EnumSet.of(JACK, QUEEN, KING);`       |
| valueOf               | ä¸€ç§æ›¿ä»£ from å’Œ of ä½†æ›´å†—é•¿çš„æ–¹æ³•                           | `BigInteger prime = BigInteger.valueOf(Integer.MAX_VALUE);`  |
| instance /getInstance | è¿”å›ä¸€ä¸ªå®ä¾‹ï¼Œè¯¥å®ä¾‹ç”±å…¶å‚æ•°ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰æè¿°ï¼Œä½†ä¸å…·æœ‰ç›¸åŒçš„å€¼ | `StackWalker luke = StackWalker.getInstance(options);`       |
| create /newInstance   | ä¸ instance æˆ– getInstance ç±»ä¼¼ï¼Œåªæ˜¯è¯¥æ–¹æ³•ä¿è¯æ¯ä¸ªè°ƒç”¨éƒ½è¿”å›ä¸€ä¸ªæ–°å®ä¾‹ | `Object newArray = Array.newInstance(classObject, arrayLen);` |
| getType               | ç±»ä¼¼äº getInstanceï¼Œä½†å¦‚æœå·¥å‚æ–¹æ³•ä½äºä¸åŒçš„ç±»ä¸­ï¼Œåˆ™ä½¿ç”¨æ­¤æ–¹æ³•ã€‚å…¶ç±»å‹æ˜¯å·¥å‚æ–¹æ³•è¿”å›çš„å¯¹è±¡ç±»å‹ | `FileStore fs = Files.getFileStore(path);`                   |
| newType               | ä¸ newInstance ç±»ä¼¼ï¼Œä½†æ˜¯å¦‚æœå·¥å‚æ–¹æ³•åœ¨ä¸åŒçš„ç±»ä¸­ä½¿ç”¨ã€‚ç±»å‹æ˜¯å·¥å‚æ–¹æ³•è¿”å›çš„å¯¹è±¡ç±»å‹ | `BufferedReader br = Files.newBufferedReader(path);`         |
| type                  | ä¸€ä¸ªç”¨æ¥æ›¿ä»£ getType å’Œ newType çš„æ¯”è¾ƒç®€å•çš„æ–¹å¼             | `List<Complaint> litany = Collections.list(legacyLitany);`   |
|                       |                                                              |                                                              |



### æ€»ç»“

é™æ€å·¥å‚æ–¹æ³•å’Œå…¬å…±æ„é€ å™¨éƒ½æœ‰å„è‡ªçš„ç”¨é€”ï¼Œç†è§£å®ƒä»¬ç›¸æ¯”è€Œè¨€çš„ä¼˜ç‚¹æ˜¯å€¼å¾—çš„ã€‚**é€šå¸¸é™æ€å·¥å‚çš„æ–¹å¼æ›´å¯å–ï¼Œå› æ­¤åº”é¿å…åœ¨æ²¡æœ‰è€ƒè™‘é™æ€å·¥å‚çš„æƒ…å†µä¸‹å°±æä¾›å…¬å…±æ„é€ å‡½æ•°ã€‚**



---

***Reference***ï¼š

1. [Effective-Java-3rd-edition-Chinese-English-bilingual/Chapter-2-Item-1-Consider-static-factory-methods-instead-of-constructors.md at dev Â· clxering/Effective-Java-3rd-edition-Chinese-English-bilingual](https://github.com/clxering/Effective-Java-3rd-edition-Chinese-English-bilingual/blob/dev/Chapter-2/Chapter-2-Item-1-Consider-static-factory-methods-instead-of-constructors.md)

