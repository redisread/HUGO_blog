---
title: "汉明码"
date: 2020-11-25T13:14:50+08:00
description: 在一个7位的信息中，单个位出错有7种可能，因此3个错误控制位就足以确定是否出错及哪一位出错了。
draft: false
hideToc: false
enableToc: true
enableTocContent: false
tocPosition: inner
author: Victor
authorEmoji: 👻
image: https://i.loli.net/2020/11/20/4BnzoQXjSFtOGDs.png
libraries:
- katex
- mathjax
tags:
- 汉明码
series:
- network
categories:
-
---



### 什么是汉明码？

看下面这张图，蓝色的表示需要发送的数据，我们就假设发送的数据为0101吧，外面橙色的码就是汉明码，汉明码是一种纠错码，但是只能纠正一个错误的比特。汉明码是添加到到发送数据后面的冗余码。每一个汉明码与同一个圆中的所有数据进行异或都是0.

![汉明码](https://i.loli.net/2020/11/20/AYnWZljoVx7pKDv.png)



### 汉明码怎么进行纠错的？

1. 假设原来的数据中一个比特错误了，如下面红色的字，原来的1变成了0

   ![](https://i.loli.net/2020/11/20/hA4GR8CawtNZ3vY.png)

   此时对于每一个园，它们进行异或的值都不是0，说明错误的地方是三个圆公共的部分，这个时候我们就可以知道错误的是中间的位置：

   ![](https://i.loli.net/2020/11/20/HAVmNSvBjQucT3x.png)

2. 假如是汉明码中的一个比特错误了，如下面红色的字，原来的0变成了1

   ![](https://i.loli.net/2020/11/20/PgJwUN18MmlXToG.png)

   此时只有右上角那个圆的所有比特异或不为0，而右上角的圆与其他圆没有关系的部分就是它的汉明码部分，所以可以推断是右上角的圆的汉明码错误了

   ![](https://i.loli.net/2020/11/20/WuchKVleLy27TGi.png)



### 汉明码放置的位置在哪里呢？

首先需要计算汉明码的校验位数。

#### 汉明码的校验位数

设数据有$n$位，校验码有$x$位。则校验码一共有$2^x$种取值方式。其中需要一种取值方式表示数据正确，剩下$2^x - 1$种取值方式表示有一位数据出错。因为编码后的二进制串有$n+x$位，因此x应该满足：$2^x -1 >= n + x$　　

**使不等式成立的x的最小值就是校验码的位数。**

假设以1010110为例进行海明码编码。

使不等式成立的x的最小值就是校验码的位数。在本例中，n=7，解得x=4。
信息码和校验码的对应关系如下表：

| 信息码位数 | 1    | 2~4  | 5~11 | 12~26 | 27~57 | 58~120 |
| ---------- | :--- | ---- | ---- | ----- | ----- | ------ |
| 校验码位数 | 2    | 3    | 4    | 5     | 6     | 7      |



**规定在采用汉明码的一串数据中，2的i次方的位置上，我们放校验码。**

![汉明码放置规则](https://i.loli.net/2020/11/20/jUIchOHEGkNmAw1.png)



更加详细的校验码位置可看下面绿色的比特，下图为分组及校验码位置图：

![校验码原理](https://i.loli.net/2020/11/25/5EY4tvO3CIjsHfD.png)

#### 汉明码如何分组，为什么？

按位置分组

* 凡是位置符合这种形式的，XXX1，归到P1；
* 凡是位置符合这种形式的，XX1X，归到P2；
* 凡是位置符合这种形式的，X1XX，归到P3；
* 凡是位置符合这种形式的，1XXX，归到P4；

……..

> 其中的规律就是使用每个比特判断数据序列的子集，然后逐步缩小范围，从时间复杂度$O(n)$降到$O(log(n))$
>





### 计算校验码？

每一行都是从对应的校验位开始校验，即从第$2^n / 2$位开始校验，校验$2^n / 2$个，然后跳过$2^n / 2$个。

下面计算本例子(以1010110为例进行海明码编码)，将表格中的位置用二进制表示：



| 位置 | 0001 | 0010 | 0011 | 0100 | 0101 | 0110 | 0111 | 1000 | 1001 | 1010 | 1011 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 内容 | x1   | x2   | 1    | x3   | 0    | 1    | 0    | x4   | 1    | 1    | 0    |





**计算x1**:

x1是第一个校验码，位置对应栏所有最后一位为1（xxx1格式）的相异或为0，即:

| 位置 | 000<font color="red">1</font> | 0010 | 001<font color="red">1</font> | 0100 | 010<font color="red">1</font> | 0110 | 011<font color="red">1</font> | 1000 | 100<font color="red">1</font> | 1010 | 101<font color="red">1</font> |
| ---- | ----------------------------- | ---- | ----------------------------- | ---- | ----------------------------- | ---- | ----------------------------- | ---- | ----------------------------- | ---- | ----------------------------- |
| 内容 | <font color="red">x1</font>   | x2   | <font color="red">1</font>    | x3   | <font color="red">0</font>    | 1    | <font color="red">0</font>    | x4   | <font color="red">1</font>    | 1    | <font color="red">0</font>    |

$$
x1 \oplus 1 \oplus 0 \oplus 0 \oplus 1 \oplus 0 = 0
$$

则x1 = 0。



**计算x2:**

x2是第二个校验码，位置对应栏所有倒数第二位为1（xx1x格式）的相异或为0，即

| 位置 | 0001 | 00<font color="red">1</font>0 | 00<font color="red">1</font>1 | 0100 | 0101 | 01<font color="red">1</font>0 | 01<font color="red">1</font>1 | 1000 | 1001 | 10<font color="red">1</font>0 | 10<font color="red">1</font>1 |
| ---- | ---- | ----------------------------- | ----------------------------- | ---- | ---- | ----------------------------- | ----------------------------- | ---- | ---- | ----------------------------- | ----------------------------- |
| 内容 | x1   | <font color="red">x2</font>   | <font color="red">1</font>    | x3   | 0    | <font color="red">1</font>    | <font color="red">0</font>    | x4   | 1    | <font color="red">1</font>    | <font color="red">0</font>    |

$$
x2 \oplus 1 \oplus 1 \oplus 0 \oplus 1 \oplus 0 = 0
$$

则x2 = 1。



**计算x3:**

x3是第三个校验码，位置对应栏所有倒数第三位为1（x1xx格式）的相异或为0，即

| 位置 | 0001 | 0010 | 0011 | 0<font color="red">1</font>00 | 0<font color="red">1</font>01 | 0<font color="red">1</font>10 | 0<font color="red">1</font>11 | 1000 | 1001 | 1010 | 1011 |
| ---- | ---- | ---- | ---- | ----------------------------- | ----------------------------- | ----------------------------- | ----------------------------- | ---- | ---- | ---- | ---- |
| 内容 | x1   | x2   | 1    | <font color="red">x3</font>   | <font color="red">0</font>    | <font color="red">1</font>    | <font color="red">0</font>    | x4   | 1    | 1    | 0    |

$$
x3 \oplus 0 \oplus 1 \oplus 0 = 0
$$

则x3 = 1。



**计算x4:**

x4是第四个校验码，位置对应栏所有倒数第四位为1（1xxx格式）的相异或为0，即

| 位置 | 0001 | 0010 | 0011 | 0100 | 0101 | 0110 | 0111 | <font color="red">1</font>000 | <font color="red">1</font>001 | <font color="red">1</font>010 | <font color="red">1</font>011 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ----------------------------- | ----------------------------- | ----------------------------- | ----------------------------- |
| 内容 | x1   | x2   | 1    | x3   | 0    | 1    | 0    | <font color="red">x4</font>   | <font color="red">1</font>    | <font color="red">1</font>    | <font color="red">0</font>    |

$$
x4 \oplus 1 \oplus 1 \oplus 0 = 0
$$

则x4 = 0。



**所以最终的汉明码为: 01100100110,即**



| 位置 | 0001 | 0010 | 0011 | 0100 | 0101 | 0110 | 0111 | 1000 | 1001 | 1010 | 1011 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 内容 | 0    | 1    | 1    | 1    | 0    | 1    | 0    | 0    | 1    | 1    | 0    |







### 如何进行校验？



1. 假设位置为1011的数据传输错误，由0变成了1，则校验纠错的过程为：
   　　将所有位置形如xxx1, xx1x, x1xx, 1xxx的数据分别异或。
   　　xxx1: 0^1^0^0^1^1 = 1
   　　xx1x: 1^1^1^0^1^1 = 1
   　　x1x: 1^0^1^0 = 0
   　　1xxx: 0^1^1^1 = 1
   　那么出错数据的位置为1011，这样便可得到出错的位置。

2. 假设同时有两个位置出错，本例中假设位置为1010对应数据由1变成0,，位置为1011对应数据由0变成1，则推出校验纠错过程：
   　　xxx1: 0^1^0^0^1^1 = 1
   　　xx1x: 1^1^1^0^0^1 = 0
   　　x1x: 1^0^1^0 = 0
   　　1xxx: 0^1^0^1 = 0
   那么校算出的错误位是0001，即第一位；但实际上是倒数第二位和最后一位都有错误，说明海明码不能校验两位以上出错的数据，即**海明码只能检测并纠正一位错误**。





### more

如果一条信息中包含更多用于纠错的位，且通过妥善安排这些纠错位使得不同的出错位产生不同的错误结果，那么我们就可以找出出错位了。在一个7位的信息中，单个位出错有7种可能，因此3个错误控制位就足以确定是否出错及哪一位出错了。

汉明研究了包括五取二码在内的编码方案，并归纳了他们的想法。



---

Reference：

1. [汉明码（海明码、hamming code）通俗易懂的解释](https://blog.csdn.net/Yonggie/article/details/83186280)
2. [海明码之编码原理和校验方法](https://blog.csdn.net/u014470361/article/details/79848824)
3. 三蓝一褐 汉明码
4. 维基百科 [https://zh.wikipedia.org/wiki/%E6%B1%89%E6%98%8E%E7%A0%81](https://zh.wikipedia.org/wiki/%E6%B1%89%E6%98%8E%E7%A0%81)